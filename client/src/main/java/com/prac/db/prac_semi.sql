DROP SEQUENCE USERNOSEQ;
DROP TABLE USERS;

CREATE SEQUENCE USERNOSEQ;


-- Login
CREATE TABLE USERS(
	USERNO NUMBER PRIMARY KEY,
	USERID VARCHAR2(1000) NOT NULL,
	USERPW VARCHAR2(1000) NOT NULL,
	USERNAME VARCHAR2(500) NOT NULL,
	USERADDR VARCHAR2(2000) NOT NULL,
	USERPHONE VARCHAR2(20) NOT NULL,
	USEREMAIL VARCHAR2(100) NOT NULL,
	USERROLE VARCHAR2(200) NOT NULL,
	
	CONSTRAINT USERS_USERID_UQ UNIQUE (USERID),
	CONSTRAINT USERS_USERPHONE_UQ UNIQUE (USERPHONE),
	CONSTRAINT USERS_USEREMAIL_UQ UNIQUE (USEREMAIL)
);

select USERNO, USERID, USERPW, USERNAME, USERADDR, USERPHONE, USEREMAIL, USERROLE from users;

INSERT INTO USERS
VALUES(USERNOSEQ.NEXTVAL, 'jane', 'password', '김제인', '서울 강남', '010-3333-3333', 'jane@gmail.com', 'MENTEE');

INSERT INTO USERS
VALUES(USERNOSEQ.NEXTVAL, 'mentor2', 'password', '김선비', '강원도', '010-2222-2222', 'kim@gmail.com', 'MENTOR');


-- Video 방 생성
DROP SEQUENCE VIDEONOSEQ;
DROP TABLE VIDEOROOMS;

CREATE SEQUENCE VIDEONOSEQ;


CREATE TABLE VIDEOROOMS(
	ROOMNO NUMBER PRIMARY KEY,
	ROOMID VARCHAR2(1000) NOT NULL,
	MENTORID VARCHAR2(1000) NOT NULL REFERENCES USERS(USERID),
	MENTEEID VARCHAR2(1000) NOT NULL REFERENCES USERS(USERID),
	REGDATE DATE NOT NULL
);

SELECT ROOMNO, ROOMID, MENTORID, MENTEEID, REGDATE FROM VIDEOROOMS ORDER BY REGDATE DESC;

DELETE FROM VIDEOROOMS WHERE MENTORID = 'mentor1';


-- Chatting 방 생성
DROP SEQUENCE CHATNOSEQ;
DROP TABLE CHATROOMS;

CREATE SEQUENCE CHATNOSEQ;

CREATE TABLE CHATROOMS(
	CHATNO NUMBER NOT NULL,
	ROOMID VARCHAR2(1000) NOT NULL PRIMARY KEY,
	CREATORID VARCHAR2(1000) NOT NULL REFERENCES USERS(USERID),
	GUESTID VARCHAR2(1000) NOT NULL REFERENCES USERS(USERID),
	REGDATE DATE NOT NULL
);

SELECT CHATNO, ROOMID, CREATORID, GUESTID, REGDATE
FROM CHATROOMS
ORDER BY REGDATE DESC;

DELETE FROM CHATROOMS WHERE CREATORID = 'jane';

-- Chatting 메세지 기록
DROP SEQUENCE CHATSEQ;
DROP TABLE CHATMESSAGES;

CREATE SEQUENCE CHATSEQ;

CREATE TABLE CHATMESSAGES(
	SEQ NUMBER PRIMARY KEY,
	ROOMID VARCHAR2(1000) NOT NULL REFERENCES CHATROOMS(ROOMID) ON DELETE CASCADE,
	SENDERID VARCHAR2(1000) NOT NULL,
	MESSAGE VARCHAR2(4000) NOT NULL,
	SENDDATE VARCHAR2(1000) NOT NULL
);

SELECT SEQ, ROOMID, SENDERID, MESSAGE, SENDDATE FROM CHATMESSAGES ORDER BY SENDDATE DESC;

DELETE FROM CHATMESSAGES;










































